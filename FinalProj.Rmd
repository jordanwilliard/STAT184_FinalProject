---
title: "FinalProject"
author: "Jordan Williard"
date: "4/26/2020"
output: html_document
---

### Workspace Initialization

```{r}
library(DataComputing)
library(tidyr)
```



### Introduction
America is on shaky political ground. The gap between left and right ideologies has been increasing to the point that the resulting tensions are almost to be expected. Fundamental differences between the ways that people view religion, abortion, immigration, and gun ownership, just to name a few, have created a polarized climate. As we approach the upcoming election cycle, it's valuable for campaigns and constituents alike to understand the ideological differences and shifts that are occuring in this nation. The following analysis is intended to observe these trends and answer the follow questions:  


### Data Access

Two data sets will be used for this analysis. The first is called the Comparative Political Data Set and contains information on demographic, political, and ideological characteristics for 36 countries from 1960 to 2017. In this data set, a case represents the political, social, and demographic information for one country, during one year. The second data set contains data collected 5 Year Surveys and Censi that has been aggregated by data.world. This data set can be used to observe population trends across America throughout the years. In this data set, a case represents the population for one zip code for years 2020-2016. 

```{r}
CPDS <- read.csv("CPDS-1960-2017-Update-2019.csv")
ZipPop <- read.csv("pop-by-zip-code.csv")

head(CPDS)
head(ZipPop)
```


## Data Wrangling

### 1
Because I am only interested in American politics, I am going to begin by filtering the CPDS dataframe to only include cases pertaining to the US. There are also many columns that will not be useful for this analysis. The relevant fields are gathered with select(). Descriptions for these fields are as follows:

* 1. year: Year of data collection.

* 2. country: Country that data pertains to (Only USA after filtering).

* 3. gov_right1: The percentage of cabinet seats held by right wing politicians.

* 4. gov_cent1: The percentage of cabinet seats held by centrist politicians.

* 5. vturn: Voter turnout in election. 

* 6. pop: Total country population

* 7. elderly: Percentage of the population that is 65 years or older. 

* 8. unemp: Amount of civilians of working age who are unemployed. 

* 9. debt: Amount of debt accumulated in the year, expressed as percent of GDP.

* 10. realgdpgr: Percent growth of GDP as compared to the previous year.

An interesting observation from this is that left wing government composition is always zero in this data. Within America, this may not make sense, but on the world stage America does not have a left leaning arm of government. For this reason, I'm only gathering central and right ideology. 

```{r}
CPDS_US <-
  CPDS %>% 
  filter(country == "USA") %>%
  select(year, country, gov_right1, gov_cent1, vturn, pop, elderly, unemp, debt, realgdpgr)

head(CPDS_US)
```

### 2
By using machine learning to create a linear regression on this data, we observe several interesting relationships in the data. Here, elderly, unemployment rates, debt, and gdp data is being used to predict the prevalence of right wing ideologies in governemnt. We can see that the amount of elderly population as well as the amount of debt acrued in a single year are statistically significant. 

```{r}
linearMod <- lm(gov_right1 ~ elderly + unemp + debt + realgdpgr, data=CPDS_US)

summary(linearMod)

```

### 3 
When looking at demographic data, one of the first considerations is whether or not the total population of a region is increasing or decreasing. One way to do this is by determining if the average population by zip code changes throughout the years. By using the reduction function mean(), we can observe this trend and notice that the average population has remained fairly stagnant since 2010, indicating that the total population of the United States has also been fairly constant in this time period. Further research (https://www.worldometers.info/world-population/us-population/) confirms this observation: Between 2010 and 2016, the total population of the United States has only risen from 309M to 323M, a 4% increase.  

```{r}
ZipPopMean <-
  ZipPop %>%
  mutate("mean2010" = mean(y.2010),
         "mean2011" = mean(y.2011),
         "mean2012" = mean(y.2012),
         "mean2013" = mean(y.2013),
         "mean2014" = mean(y.2014),
         "mean2015" = mean(y.2015),
         "mean2016" = mean(y.2016),
         ) %>%
  select(mean2010, mean2011, mean2012, mean2013, mean2014, mean2015, mean2016)

 avg_sizes <- ZipPopMean[!duplicated(ZipPopMean$mean2010),]
 
 avg_sizes
```

### 4
The data in ZipPop is obviously not in a tidy format. In its initial state, a case represents a zip codes population across all years (2010-2016). Fortunately, a call to the wrangling function gather() can transform this into tidy data in which each case represents the population for a single zip code, in a single year. 

```{r}
ZipPopNarrow <-
  ZipPop %>%
  gather(Year, Population, -zip_code)
head(ZipPopNarrow)
nrow(ZipPopNarrow)
```

### 5
While the gather() function helped create tiny data, when the column headers for years were turned into keys they kept the leading "y." which will eliminate the use of any arithmetic pertaining to years. To resolve this, a regular expression will be used to remove any characters from the Year column that are not numeric. 

```{r}
ZipPopNarrow <-
  ZipPopNarrow %>%
  mutate(Year = gsub(pattern = "[^0-9-]", "", Year))
head(ZipPopNarrow)
```

## Data Visualizations